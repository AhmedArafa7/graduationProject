<div class="flex min-h-screen items-center justify-center bg-[#F8F9FA] dark:bg-[#14161e] py-12 px-4 sm:px-6 lg:px-8 font-display">
  <div class="w-full max-w-md space-y-8 bg-white dark:bg-[#1F232D] p-8 rounded-xl shadow-lg border border-[#DEE2E6] dark:border-gray-700">
    
    @if (!isSent()) {
      <div class="text-center">
        <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4 text-primary">
          <span class="material-symbols-outlined text-3xl">lock_reset</span>
        </div>
        <h2 class="mt-2 text-3xl font-bold tracking-tight text-[#212529] dark:text-white">نسيت كلمة المرور؟</h2>
        <p class="mt-2 text-sm text-[#6C757D]">لا تقلق، أدخل بريدك الإلكتروني وسنرسل لك رابط إعادة تعيين كلمة المرور.</p>
      </div>

      <form #forgotForm="ngForm" (submit)="onSubmit(forgotForm); $event.preventDefault()" class="mt-8 space-y-6" novalidate>
        
        <div>
          <label for="email-address" class="block text-sm font-medium text-text-secondary dark:text-gray-300 mb-2">البريد الإلكتروني</label>
          <input [ngModel]="email()" (ngModelChange)="email.set($event)" #emailCtrl="ngModel" id="email-address" name="email" type="email" 
                 dir="ltr"
                 class="relative block w-full rounded-lg border bg-gray-50 dark:bg-gray-800 px-4 py-3 text-[#212529] dark:text-white placeholder-gray-400 focus:z-10 focus:ring-2 focus:ring-[#2C3E87]/50 text-right sm:text-sm transition-all outline-none" 
                 [class.border-red-500]="emailCtrl.invalid && (emailCtrl.dirty || emailCtrl.touched)"
                 [class.border-[#DEE2E6]]="!emailCtrl.invalid"
                 [class.dark:border-gray-600]="!emailCtrl.invalid"
                 [class.focus:border-red-500]="emailCtrl.invalid && (emailCtrl.dirty || emailCtrl.touched)"
                 [class.focus:border-[#2C3E87]]="!emailCtrl.invalid"
                 placeholder="name@example.com" required pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$">
          
          @if (emailCtrl.invalid && (emailCtrl.dirty || emailCtrl.touched)) {
            <div class="text-red-500 text-xs mt-1.5 font-bold animate-fadeIn">
              @if (emailCtrl.hasError('required')) { البريد الإلكتروني مطلوب }
              @if (emailCtrl.hasError('pattern')) { صيغة البريد الإلكتروني غير صحيحة }
            </div>
          }
        </div>

        <div>
          <button type="submit" [disabled]="isSubmitting()"
                  class="group relative flex w-full justify-center rounded-lg bg-[#2C3E87] px-4 py-3 text-sm font-bold text-white hover:bg-[#2C3E87]/90 transition-all disabled:opacity-70 disabled:cursor-not-allowed cursor-pointer shadow-md transform active:scale-[0.99]">
            @if (isSubmitting()) {
              <span class="material-symbols-outlined animate-spin text-lg">progress_activity</span>
            } @else {
              إرسال رابط الاستعادة
            }
          </button>
        </div>
      </form>
    } @else {
      <div class="text-center animate-fadeIn">
        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600">
          <span class="material-symbols-outlined text-3xl">mark_email_read</span>
        </div>
        <h2 class="text-2xl font-bold text-[#212529] dark:text-white">تحقق من بريدك</h2>
        <p class="mt-2 text-sm text-[#6C757D] mb-6 leading-relaxed">
          لقد أرسلنا رابط إعادة تعيين كلمة المرور إلى: <br>
          <span class="font-bold text-primary dir-ltr inline-block mt-1">{{ email() }}</span>
        </p>
        
        <div class="text-xs text-gray-500 mb-6 flex flex-col items-center gap-2">
          <p>لم يصلك البريد؟</p>
          <button (click)="resendLink()" 
                  [disabled]="isResending()"
                  class="text-primary font-bold hover:underline cursor-pointer disabled:opacity-50 disabled:cursor-wait flex items-center gap-1">
            @if (isResending()) {
              <span class="material-symbols-outlined animate-spin text-xs">progress_activity</span>
              جاري الإرسال...
            } @else {
              إعادة الإرسال
            }
          </button>
        </div>
      </div>
    }

    <div class="text-center border-t border-gray-100 dark:border-gray-700 pt-6">
      <a routerLink="/auth/login" class="font-bold text-[#2C3E87] hover:text-[#2C3E87]/80 text-sm flex items-center justify-center gap-1 transition-colors cursor-pointer">
        <span class="material-symbols-outlined text-lg rtl:rotate-180">arrow_back</span>
        العودة لتسجيل الدخول
      </a>
    </div>

  </div>
</div>